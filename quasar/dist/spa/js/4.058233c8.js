(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"8b24":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{},[a("loginForm")],1)},i=[],s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"q-pa-xl"},[a("q-stepper",{ref:"stepper",attrs:{color:"primary",animated:"","done-color":"green","header-nagivation":!1,"no-header-navigation":""},scopedSlots:e._u([{key:"navigation",fn:function(){return[a("q-stepper-navigation",[a("q-btn",{staticStyle:{color:"##0C71C3"},attrs:{color:"primary",label:2===e.step?"Entrar":"Proximo"},on:{click:function(t){return e.nextStep()}}}),e.step>1?a("q-btn",{staticClass:"q-ml-sm",staticStyle:{color:"##0C71C3"},attrs:{flat:"",label:"Voltar"},on:{click:function(t){return e.$refs.stepper.previous()}}}):e._e(),a("q-btn",{staticClass:"q-ml-sm float-right",attrs:{flat:"",color:"primary",label:"Registrar"},on:{click:e.redirect_register}}),a("q-btn",{staticClass:"q-ml-sm float-right",staticStyle:{color:"#E31E17"},attrs:{flat:"",label:"Esqueceu a senha?"},on:{click:e.redirect_password}})],1)]},proxy:!0}]),model:{value:e.step,callback:function(t){e.step=t},expression:"step"}},[a("q-step",{attrs:{name:1,icon:"email",done:e.step>1,title:"email"}},[a("div",{staticClass:"q-ma-none q-pb-lg"},[a("div",{staticClass:"text-h4 text-weight-thin"},[e._v("Login")]),a("hr")]),a("q-input",{ref:"email",attrs:{filled:"",autofocus:"",type:"email",label:"Seu email",rules:[function(e){return""!==e.email||"Digite um Email"},function(e){return-1!==e.indexOf("@")||"Digite um Email Válido"},function(t){return e.errorInput.errorEmail||"Não existe usuario com este email"},function(e){return e.indexOf("@")!==e.length-1||"Digite um Email Válido"}],"lazy-rules":"ondemand",loading:e.loadingState},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.nextStep(t))}},model:{value:e.formulario.email,callback:function(t){e.$set(e.formulario,"email",t)},expression:"formulario.email"}})],1),a("q-step",{attrs:{name:2,icon:"password",done:e.step>2,title:"senha"}},[a("div",{staticClass:"q-ma-none q-pb-lg"},[a("div",{staticClass:"text-h4 text-weight-thin"},[e._v("Login")]),a("hr")]),a("q-input",{ref:"senha",attrs:{filled:"",label:"Sua senha",type:e.isPwd?"password":"text",autocomplete:"off",rules:[function(t){return e.errorInput.errorPassword||"Digite uma senha válida"}],loading:e.loadingState,"lazy-rules":"ondemand"},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.nextStep(t))}},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:e.isPwd?"visibility_off":"visibility"},on:{click:function(t){e.isPwd=!e.isPwd}}})]},proxy:!0}]),model:{value:e.formulario.senha,callback:function(t){e.$set(e.formulario,"senha",t)},expression:"formulario.senha"}})],1)],1)],1)},o=[],n=(a("e6cf"),a("758b")),l={data(){return{step:1,loadingState:!1,isPwd:!0,formulario:{senha:"",email:"",idCliente:"",passwordhash:""},errorInput:{errorEmail:!0,errorPassword:!0}}},methods:{async getUrl(){n["a"].post("",{action:"CreateSsoToken",uid:this.formulario.idCliente}).then((e=>{console.log(e),"success"===e.data.result?(this.url=e.data.redirect_url,window.location.href=this.url):console.log("Erro nos dados informados")})).catch((e=>{console.log(e)}))},async login(){this.$refs.senha.validate(),this.$refs.senha.hasError||""===this.formulario.senha?(this.errorInput.errorPassword=!1,this.$refs.senha.validate(),this.errorInput.errorPassword=!0,this.mostrarMensagem("Para continuar, por favor informe uma senha.")):(this.loadingState=!0,n["a"].post("",{action:"ValidateLogin",email:this.formulario.email,senha:this.formulario.senha}).then((e=>{console.log(e),"success"===e.data.result?(this.formulario.idCliente=e.data.userid,this.formulario.passwordhash=e.data.passwordhash,this.getUrl(),this.loadingState=!1):"password"===e.data.result&&(this.loadingState=!1,this.errorInput.errorPassword=!1,this.$refs.senha.validate(),this.errorInput.errorPassword=!0,this.mostrarMensagem("senha inválida"))})).catch((e=>{this.loadingState=!1,console.log(e)})))},nextStep(){1===this.step?(this.$refs.email.validate(),this.$refs.email.hasError||""===this.formulario.email?(this.$refs.email.validate(),this.mostrarMensagem("Para continuar, por favor informe um email válido."),this.$refs.email.focus()):this.checkEmail()):this.login()},async checkEmail(){this.loadingState=!0,n["a"].post("",{action:"checkEmail",email:this.formulario.email}).then((e=>{"success"===e.data.result?(this.$refs.email.validate(),this.$refs.stepper.next(),setTimeout((()=>{this.$refs.senha.focus()}),200)):"notin"===e.data.result&&(this.errorInput.errorEmail=!1,this.$refs.email.validate(),this.errorInput.errorEmail=!0),this.loadingState=!1})).catch((e=>{this.loadingState=!1,console.log(e)}))},mostrarMensagem(e){this.$q.notify({progress:!0,message:e,color:"primary",multiLine:!0,actions:[{label:"Entendi",color:"yellow",handler:()=>{}}]})},redirect_register(){n["a"].post("",{action:"redirect_register"}).then((e=>{window.location.href=e.data}))},redirect_password(){n["a"].post("",{action:"redirect_password"}).then((e=>{window.location.href=e.data}))}}},c=l,u=a("2877"),d=a("f531"),h=a("87fe"),m=a("27f9"),p=a("0016"),f=a("b19c"),g=a("9c40"),w=a("eebe"),v=a.n(w),y=Object(u["a"])(c,s,o,!1,null,null,null),b=y.exports;v()(y,"components",{QStepper:d["a"],QStep:h["a"],QInput:m["a"],QIcon:p["a"],QStepperNavigation:f["a"],QBtn:g["a"]});var k={components:{loginForm:b},name:"PageIndex",created(){},methods:{}},x=k,S=a("9989"),q=Object(u["a"])(x,r,i,!1,null,null,null);t["default"]=q.exports;v()(q,"components",{QPage:S["a"]})}}]);